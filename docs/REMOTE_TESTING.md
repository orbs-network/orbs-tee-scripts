# Remote Testing Guide - ORBS TEE Price Oracle

**Date**: 2025-11-03
**Public IP**: `35.179.36.200`
**Host API Port**: `8080`

---

## üåê Remote API Access

The ORBS TEE Host API is now accessible remotely at:

```
http://35.179.36.200:8080
```

**Note**: Make sure AWS Security Group allows inbound traffic on port 8080.

---

## üöÄ Quick Test from Your Machine

### 1. Health Check

```bash
curl http://35.179.36.200:8080/api/v1/health
```

**Expected Response**:
```json
{
  "status": "healthy",
  "enclaveConnected": true,
  "l3Reachable": false,
  "uptimeSeconds": 120
}
```

---

### 2. Get Bitcoin Price (BTCUSDT)

```bash
curl -X POST http://35.179.36.200:8080/api/v1/request \
  -H "Content-Type: application/json" \
  -d '{"method":"get_price","params":{"symbol":"BTCUSDT"}}'
```

**Expected Response**:
```json
{
  "id": "...",
  "success": true,
  "data": {
    "symbol": "BTCUSDT",
    "price": "107540.26000000",
    "timestamp": 1762180568,
    "source": "binance"
  },
  "signature": "f5dc83d16c805521ecf426ebdc17bfee29e6a2a84a96b020e6c63bc8513bc55356e2a1a3fbd3bc504d3e795bf910c007824405479530f8675aa61648a9131b6e"
}
```

---

### 3. Get Ethereum Price (ETHUSDT)

```bash
curl -X POST http://35.179.36.200:8080/api/v1/request \
  -H "Content-Type: application/json" \
  -d '{"method":"get_price","params":{"symbol":"ETHUSDT"}}'
```

---

### 4. Get Solana Price (SOLUSDT)

```bash
curl -X POST http://35.179.36.200:8080/api/v1/request \
  -H "Content-Type: application/json" \
  -d '{"method":"get_price","params":{"symbol":"SOLUSDT"}}'
```

---

### 5. Get System Status

```bash
curl http://35.179.36.200:8080/api/v1/status
```

**Expected Response**:
```json
{
  "hostVersion": "0.1.0",
  "status": "healthy",
  "enclaveConnected": true,
  "l3Reachable": false,
  "l3GuardiansReachable": 0,
  "uptimeSeconds": 300,
  "requestsProcessed": 42
}
```

---

## üìä Enclave Information

### Public Key
```
0x031f4d194cb9fe43c00d3554645211a31a60a6cae9cfae0bfab73d090c301f11b5
```

This is the **real ECDSA public key** generated by the enclave. All responses are signed with the corresponding private key (which never leaves the enclave).

### Signature Verification

Every price response includes an ECDSA signature. To verify:

1. Extract the `data` field from the response
2. Hash it with SHA-256
3. Verify the signature using the public key above
4. Use secp256k1 curve

**Example signature** (64 bytes hex):
```
f5dc83d16c805521ecf426ebdc17bfee29e6a2a84a96b020e6c63bc8513bc55356e2a1a3fbd3bc504d3e795bf910c007824405479530f8675aa61648a9131b6e
```

---

## üîß Available Symbols

Any symbol supported by Binance API:
- **BTCUSDT** - Bitcoin
- **ETHUSDT** - Ethereum
- **SOLUSDT** - Solana
- **ADAUSDT** - Cardano
- **DOTUSDT** - Polkadot
- **LINKUSDT** - Chainlink
- **MATICUSDT** - Polygon
- **AVAXUSDT** - Avalanche
- And many more...

---

## üß™ Testing from Different Languages

### JavaScript/Node.js

```javascript
const axios = require('axios');

async function getPrice(symbol) {
  const response = await axios.post('http://35.179.36.200:8080/api/v1/request', {
    method: 'get_price',
    params: { symbol }
  });

  console.log(`${symbol}: $${response.data.data.price}`);
  console.log(`Signature: ${response.data.signature}`);
}

getPrice('BTCUSDT');
```

### Python

```python
import requests

def get_price(symbol):
    response = requests.post(
        'http://35.179.36.200:8080/api/v1/request',
        json={
            'method': 'get_price',
            'params': {'symbol': symbol}
        }
    )
    data = response.json()
    print(f"{symbol}: ${data['data']['price']}")
    print(f"Signature: {data['signature']}")

get_price('ETHUSDT')
```

### Go

```go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
)

func getPrice(symbol string) {
    payload := map[string]interface{}{
        "method": "get_price",
        "params": map[string]string{"symbol": symbol},
    }

    jsonData, _ := json.Marshal(payload)
    resp, _ := http.Post(
        "http://35.179.36.200:8080/api/v1/request",
        "application/json",
        bytes.NewBuffer(jsonData),
    )

    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)

    fmt.Printf("%s: $%v\n", symbol, result["data"].(map[string]interface{})["price"])
    fmt.Printf("Signature: %v\n", result["signature"])
}

func main() {
    getPrice("SOLUSDT")
}
```

---

## üîí Security Notes

### Current Configuration
- **Enclave**: Real ECDSA signatures (secp256k1)
- **Host**: No TLS (HTTP only - for testing)
- **Authentication**: Disabled
- **Rate Limiting**: Disabled

### For Production
1. Enable TLS on host (HTTPS)
2. Enable DApp authentication
3. Enable rate limiting
4. Deploy to actual AWS Nitro Enclave for hardware attestation
5. Configure L3 guardian network integration

---

## üìà Performance

| Metric | Value |
|--------|-------|
| Avg Response Time | <100ms |
| Price Data Source | Binance API (real-time) |
| Signature Generation | Real ECDSA (secp256k1) |
| Enclave Type | Unix Socket (testing) |
| Host Framework | TypeScript/Express |

---

## üêõ Troubleshooting

### Cannot Connect

Check if port 8080 is accessible:
```bash
telnet 35.179.36.200 8080
```

If it fails, AWS Security Group may be blocking the port.

### Connection Timeout

The host might be down. SSH to the server and check:
```bash
ssh ubuntu@35.179.36.200
ps aux | grep node
```

### Enclave Disconnected

If health check shows `"enclaveConnected": false`, the enclave process crashed. Restart it:
```bash
cd /home/ubuntu/orbs-tee-enclave-nitro/examples/price-oracle-unix
./target/debug/price-oracle-unix &
```

---

## üìù API Reference

### GET /api/v1/health

**Response**:
```typescript
{
  status: "healthy" | "unhealthy",
  enclaveConnected: boolean,
  l3Reachable: boolean,
  uptimeSeconds: number
}
```

### GET /api/v1/status

**Response**:
```typescript
{
  hostVersion: string,
  status: "healthy" | "unhealthy",
  enclaveConnected: boolean,
  l3Reachable: boolean,
  l3GuardiansReachable: number,
  uptimeSeconds: number,
  requestsProcessed: number
}
```

### POST /api/v1/request

**Request**:
```typescript
{
  method: "get_price" | "get_attestation",
  params: {
    symbol?: string  // For get_price
  }
}
```

**Response**:
```typescript
{
  id: string,
  success: boolean,
  data?: object,
  signature?: string,  // 64-byte hex ECDSA signature
  error?: string
}
```

---

## ‚úÖ Verification Checklist

- [ ] Can access health endpoint from your machine
- [ ] Can fetch BTC price
- [ ] Can fetch ETH price
- [ ] Responses include signatures
- [ ] Prices are real-time from Binance
- [ ] Response time is acceptable (<200ms)

---

## üìû Support

If you encounter issues:
1. Check AWS Security Group allows port 8080
2. Verify services are running on the server
3. Check server logs: `/tmp/host.log` and `/tmp/real-enclave.log`
4. Review system status with session status scripts

---

**System Status**: ‚úÖ OPERATIONAL
**Last Updated**: 2025-11-03 14:40 UTC
**Enclave Public Key**: `0x031f4d194cb9fe43c00d3554645211a31a60a6cae9cfae0bfab73d090c301f11b5`
